


QKV fusion 
- Merging local Xq, Xk, Xv
- Column-wise allReduce + broadcast
- 3 * dim_p_pe * bsz
Scoring 
- Xq * K
- [1, dim_p_pe] * [dim_p_pe, seq_len_local]
- Row-wise allReduce + broadcast
- 


Written with [StackEdit](https://stackedit.io/).
> 
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTY1MjExODc5Nyw3MzA5OTgxMTZdfQ==
-->