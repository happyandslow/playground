

## A* mapper mapping chain
### Initialization Chain

```
map()
├─ OperatorPredictor.__init__()
├─ MemoryModel.__init__()
│ └─ _build_tensor_sizes()
├─ ExpansionManager.set_graph()
├─ HeuristicCalculator.__init__()
├─ SolutionEvaluator.__init__()
├─ OperatorPartitioner.__init__()
├─ SolutionCollector.__init__()
├─ BestPathLeafCollector.__init__()
├─ CutHelper.__init__()
├─ analyze_cross_group_dependencies()
│ └─ GroupDependencyGraph.from_dependencies()
├─ DependencyAwareAllocator.__init__()
│ └─ GlobalPEAllocator.__init__()
├─ DependencyAwareAllocator.allocate_chain_groups()
├─ TuneHelper.__init__()
└─ SpatialIR.__init__()

```

  

### Mapping Chain

```
map()
└─ _map_groups_parallel() OR _map_group()
├─ _compute_dependency_levels()
└─ _map_group()
├─ _create_root_node()
│ └─ _find_optimal_initial_region()
├─ _lookup_op_group_cache()
├─ SmallGroupOptimizer.optimize()
└─ A* Search Loop
├─ _expand_node()
│ ├─ ExpansionManager.expand()
│ │ ├─ SpatialCutStrategy.apply()
│ │ ├─ TemporalCutStrategy.apply()
│ │ ├─ EdgeTuneStrategy.apply()
│ │ └─ GemmTuneStrategy.apply()
├─ _compute_heuristic()
│ └─ HeuristicCalculator.compute_heuristic()
├─ _evaluate_complete_solution()
│ └─ SolutionEvaluator.evaluate()
└─ _apply_mapping_to_spatial_ir()
└─ SolutionCollector.collect()

```

  

### Post-Processing Chain

```
map()
├─ _calculate_pe_utilization()
├─ _compress_pe_allocation()
├─ _build_timeline()
├─ shrink_idle_pes()
└─ MappingResult.__init__()
```


## Evaluation Flow
```
During A* Search:
  For each node:
    f_cost = HeuristicCalculator.compute_heuristic(node)
             ├─ g_cost: Sum of CostModel.compute_op_cost() for fixed groups
             └─ h_cost: Estimate for remaining groups
    
    MemoryModel.check_memory_feasibility(node) → Prune if infeasible

When complete solution found:
  total_cost = SolutionEvaluator.evaluate(node, graph)
               ├─ For each leaf: CostModel.compute_op_cost()
               ├─ Communication: CostModel.compute_communication_cost()
               └─ Dependency scheduling: Sequential vs parallel execution
```
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTc5NTQzNzI4M119
-->